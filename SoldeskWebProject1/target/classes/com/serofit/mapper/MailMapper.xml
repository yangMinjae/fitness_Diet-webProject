<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.serofit.mapper.MailMapper">

	<!-- 받은 사람 기준으로 메일 불러오기 -->
	<select id="selectByReceiver" resultType="com.serofit.domain.MailVO" parameterType="int">
		SELECT * FROM tbl_mail WHERE receiver=#{receiver} ORDER BY REGDATE DESC
	</select>
	
	<!-- 메일 보내기 -->
	<insert id="insertMail" parameterType="com.serofit.domain.MailVO">
		INSERT INTO tbl_mail
		VALUES(
			seq_mail.nextval,
			#{receiver},
			#{sender},
			#{content},
			sysdate,
			default
		)
	</insert>
	
	<!-- MNO로 메일 삭제 -->
	<delete id="deleteMailByMno" parameterType="int">
		DELETE FROM tbl_mail WHERE mno=#{mno} 
	</delete>
	
	<!-- 탈퇴 시 메일 전체 삭제 -->
	<delete id="deleteMailByUno" parameterType="com.serofit.domain.MailVO">
		DELETE FROM tbl_mail WHERE receiver=#{receiver} OR sender=#{sender}
	</delete>
	
	<!-- 메일 갯수 가져오기 -->
	<select id="selectMailCountBySender" parameterType="int" resultType="int">
		SELECT COUNT(*) FROM tbl_mail WHERE sender=#{sender} AND hit=0
	</select>
</mapper>
